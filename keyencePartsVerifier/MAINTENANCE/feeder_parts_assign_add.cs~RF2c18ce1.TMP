using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Data.SqlClient;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace keyencePartsVerifier.MAINTENANCE
{
    public partial class feeder_parts_assign_add : Form
    {
        public feeder_parts_assign_add()
        {
            InitializeComponent();
        }
        int selector = 0;
        private void btn_close_Click(object sender, EventArgs e)
        {
            this.Close();
        }

        private void feeder_parts_assign_add_Load(object sender, EventArgs e)
        {
            if (!bw_open.IsBusy)
            {
                bw_open.RunWorkerAsync(500);
            }
        }

        private void bw_open_DoWork(object sender, DoWorkEventArgs e)
        {
            BackgroundWorker worker = sender as BackgroundWorker;
            for(int i=0;i<=5;i++)
            {
                worker.ReportProgress(i);
                System.Threading.Thread.Sleep(50);
            }
        }

        private void bw_open_ProgressChanged(object sender, ProgressChangedEventArgs e)
        {
            if(selector==1)
            {
                txt_status.Text = "Please wait. . .";
                _loadProducts();
            }
            else if(selector==2)
            {
                _loadLine();
            }
        }

        private void bw_open_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            selector++;

            if(selector<=5)
            {
                bw_open.RunWorkerAsync(500);
            }
            else
            {
                toolStripProgressBar1.Visible = false;
            }
            
        }
        private void _loadProducts()
        {
            try
            {
                SqlCommand cmdS = new SqlCommand("SELECT DISTINCT productID, productName FROM tbl_web_products ORDER by productName", gclass.con);
                gclass.con.Open();
                SqlDataAdapter da=new SqlDataAdapter(cmdS);
                DataTable dt = new DataTable();
                da.Fill(dt);
                gclass.con.Close();

                cb_product.DataSource = dt;
                cb_product.DisplayMember = "productName";
                cb_product.ValueMember = "productID";
            }
            catch(Exception ex)
            {
                MessageBox.Show("Error on loading products! Please contact administrator! Details: "+ex.Message, "Error: SQL", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
        }
        private void _loadLine()
        {
            try
            {
                SqlCommand cmdS = new SqlCommand("SELECT DISTINCT lineID, lineName FROM tbl_web_line ORDER by lineName", gclass.con);
                gclass.con.Open();
                SqlDataAdapter da = new SqlDataAdapter(cmdS);
                DataTable dt = new DataTable();
                da.Fill(dt);
                gclass.con.Close();

                cb_line.DataSource = dt;
                cb_line.DisplayMember = "lineName";
                cb_line.ValueMember = "lineID";
            }
            catch (Exception ex)
            {
                MessageBox.Show("Error on loading line! Please contact administrator! Details: " + ex.Message, "Error: SQL", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
        }
        private void _loadTable()
        {
            try
            {
                SqlCommand cmdS = new SqlCommand("SELECT DISTINCT tableID, tableName FROM tbl_web_table ORDER by tableName", gclass.con);
                gclass.con.Open();
                SqlDataAdapter da = new SqlDataAdapter(cmdS);
                DataTable dt = new DataTable();
                da.Fill(dt);
                gclass.con.Close();

                cb_table.DataSource = dt;
                cb_table.DisplayMember = "tableName";
                cb_table.ValueMember = "tableID";
            }
            catch (Exception ex)
            {
                MessageBox.Show("Error on loading table! Please contact administrator! Details: " + ex.Message, "Error: SQL", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
        }
        private void _loadFeeder()
        {
            try
            {
                SqlCommand cmdS = new SqlCommand("SELECT DISTINCT tableID, tableName FROM tbl_web_table ORDER by tableName", gclass.con);
                gclass.con.Open();
                SqlDataAdapter da = new SqlDataAdapter(cmdS);
                DataTable dt = new DataTable();
                da.Fill(dt);
                gclass.con.Close();

                cb_table.DataSource = dt;
                cb_table.DisplayMember = "tableName";
                cb_table.ValueMember = "tableID";
            }
            catch (Exception ex)
            {
                MessageBox.Show("Error on loading table! Please contact administrator! Details: " + ex.Message, "Error: SQL", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
        }

    }
}
